# Exercise 02 - ğŸªì¿ í‚¤ë‚˜ë¼ğŸªì˜ passport ì‹œìŠ¤í…œ!

|                      |                                         |
| :--------------------| --------------------------------------- |
|   ì œì¶œí•  í´ë” ì´ë¦„ :     |  ex02                                  |
|   ì œì¶œí•  íŒŒì¼ ì´ë¦„ :     | Express í”„ë¡œì íŠ¸ì— í•„ìš”í•œ ëª¨ë“  íŒŒì¼ |
|   ì‚¬ìš© ê°€ëŠ¥í•œ ì™¸ë¶€ ëª¨ë“ˆ : |  express, jsonwebtoken, passport, passport-jwt, validator, dotenv, nodemon, [Expressjs teamì—ì„œ ì§€ì›í•˜ëŠ” middleware](http://expressjs.com/en/resources/middleware.html)  |
|   ì°¸ê³ ì‚¬í•­ :           |  ì—†ìŒ                                    |

ìµœê·¼ `ì¿ í‚¤ë‚˜ë¼` ì—ì„œ ì „ì„¸ê³„ ê³µìš©ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” `passport-jwt` ë¥¼ ì‚¬ìš©í•˜ê¸°ë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤!

ì—¬ëŸ¬ë¶„ë“¤ì€ ì•„ë˜ì˜ ì‚¬í•­ì„ ì§€ì¼œì„œ êµ¬í˜„í•´ ì£¼ì„¸ìš”!

### ì œì•½ ì‚¬í•­

- JWT SECRET KEYëŠ” code ë‚´ë¶€ì— rawë¡œ ì‘ì„±ë˜ì–´ ìˆìœ¼ë©´ ì•ˆë©ë‹ˆë‹¤.
- expiratonì„ ì„¤ì • í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.
- ì¸ì¦ìœ ì €ë¥¼ êµ¬ë¶„í•˜ëŠ” ë¡œì§ì€ middle wareë¡œ êµ¬í˜„ì„ í•´ì•¼ í•©ë‹ˆë‹¤.
- jwtì˜ payload ë‚´ë¶€ì—ëŠ” ë°˜ë“œì‹œ `username` í•„ë“œê°€ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
- passport-jwt ê²€ì¦í•˜ëŠ” ë¡œì§ì—ì„œ `rea.user` ì— payloadê°€ ì£¼ì…ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
- Token ì „ë‹¬ ë°©ì‹ì€ `Bearer Authentication` ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.

> â„¹ï¸
> https://datatracker.ietf.org/doc/html/rfc6750

### API ëª…ì„¸

- **URL**
  `/passport`
- **Method**
  `GET`
- **Params**
  - None
- **Query**
  - None
- **Body**
  - None
- **Header**
  - `Authentication`
- **Cookies**
  - None
- Authentication ì„±ê³µì‹œ
  - body
    ```js
    // jwt payload
    /*
    {
      'exp': 4242424242
      'username': 'jaeskim'
    }
    */
    {
      "msg" : "ğŸª jaeskimë‹˜ ì¿ í‚¤ì˜ ì„¸ìƒì— ì˜¤ì‹  ê±¸ í™˜ì˜ í•©ë‹ˆë‹¤~! ğŸª"
    }
    ```
- ì˜ëª»ëœ ìš”ì²­ ì‹œ
  - body
    ```js
    {
      "msg" : "ğŸª ì¿ í‚¤ì˜ ì„¸ìƒì— ì•„ë¬´ë‚˜ ì¶œì… í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!! ğŸª",
      "reason": [
        "???" // í•´ë‹¹í•˜ëŠ” ì˜¤ë¥˜ í•­ëª© ë“¤ì„ ì¶”ê°€ í•´ì£¼ì„¸ìš”.
      ]
    }
    ```

- **URL**
  `/passport`
- **Method**
  `POST`
- **Params**
  - None
- **Query**
  - None
- **Body** - *json*
  - username
    - type: string
- **Cookies**
  - None
- ë°œê¸‰ ì„±ê³µì‹œ
  - body
    ```json
    {
      "msg" : "ğŸª ì—¬ê¶Œ ë°œê¸‰ ì„±ê³µ! ğŸª",
      "token" : "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjQyNDI0MjQyNDIsInVzZXJuYW1lIjoiamFlc2tpbSJ9.BMexiK1IQG8CQ8ckiI3kB3JsXArhZnAEZI0NFFYnCs4"
    }
    ```
- ì˜ëª»ëœ ìš”ì²­ ì‹œ
  - body
    ```js
    {
      "msg" : "ğŸª ì—¬ê¶Œ ë°œê¸‰ ì‹¤íŒ¨! ğŸª".
      "reason": [
        "???" // í•´ë‹¹í•˜ëŠ” ì˜¤ë¥˜ í•­ëª© ë“¤ì„ ì¶”ê°€ í•´ì£¼ì„¸ìš”.
      ]
    }
    ```

